<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FURINA studies with you</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", sans-serif;
      }
      body {
        background: linear-gradient(to right, #50c8b1, #50c8b1);
        background-image: url("furina.jpg");
        background-repeat: no-repeat;
        background-position: center;
        background-attachment: fixed;
        background-size: contain;
        min-height: 100vh;
        color: #fff;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      nav {
        position: absolute;
        top: 10px;
        right: 10px;
        z-index: 10;
      }
      .menu-icon {
        font-size: 26px;
        cursor: pointer;
        background: rgba(255, 255, 255, 0.9);
        padding: 8px 12px;
        border-radius: 8px;
        color: black;
      }
      .menu {
        display: none;
        position: absolute;
        top: 45px;
        right: 0;
        background: rgba(255, 255, 255, 0.95);
        list-style: none;
        padding: 10px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
      }
      .menu li {
        padding: 10px 20px;
        cursor: pointer;
        color: black;
      }
      .menu li:hover {
        background: #eee;
      }
      .content {
        display: none;
        text-align: center;
        margin-top: 40px;
        max-width: 500px;
        width: 100%;
      }
      .active {
        display: block;
      }
      h1,
      h2 {
        margin-bottom: 20px;
        font-size: 24px;
        text-shadow: 1px 1px 3px black;
      }
      #vocab-list {
        background: rgba(255, 255, 255, 0.9);
        padding: 20px;
        border-radius: 10px;
        color: black;
        text-align: left;
      }
      .question-box {
        background: rgba(255, 255, 255, 0.95);
        padding: 20px;
        border-radius: 10px;
        margin-top: 20px;
        box-shadow: 0 0 8px rgba(0, 0, 0, 0.2);
        color: black;
      }
      .answers button {
        width: 100%;
        margin: 10px 0;
        padding: 12px;
        font-size: 16px;
        border-radius: 8px;
        border: none;
        background: #eee;
        cursor: pointer;
      }
      .answers button:hover {
        background: #ddd;
      }
      .summary,
      .status-bar {
        margin-top: 20px;
        font-size: 18px;
      }
      .buttons {
        margin-top: 20px;
      }
      .buttons button {
        margin: 5px;
        padding: 10px 15px;
        font-size: 16px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        background: white;
        color: black;
      }
      #exit-btn {
        position: absolute;
        top: 10px;
        left: 10px;
        background: rgba(255, 50, 50, 0.9);
        color: white;
        border: none;
        padding: 8px 12px;
        font-size: 16px;
        border-radius: 8px;
        cursor: pointer;
        z-index: 10;
        display: none;
      }
      @media (max-width: 600px) {
        h1,
        h2 {
          font-size: 20px;
        }
        .answers button,
        .menu li {
          font-size: 15px;
        }
      }
    </style>
  </head>
  <body>
    <button id="exit-btn" onclick="showPage('home')">‚ùå Tho√°t</button>
    <nav>
      <div class="menu-icon" onclick="toggleMenu()">‚ò∞</div>
      <ul class="menu" id="menu">
        <li onclick="showPage('home')">Trang ch·ªß</li>
        <li onclick="showPage('vocab')">T·ª´ v·ª±ng</li>
        <li onclick="showPage('game')">Luy·ªán t·∫≠p</li>
      </ul>
    </nav>

    <div class="content" id="game">
      <h2>üß† Tr√≤ ch∆°i luy·ªán t·∫≠p</h2>

      <!-- Th√™m ph·∫ßn ch·ªçn m·ª©c ƒë·ªô -->
      <div id="level-select" style="margin-bottom: 20px">
        <button onclick="startGame(20)">B√¨nh th∆∞·ªùng (20 c√¢u)</button>
        <button onclick="startGame(50)">Kh√≥ (50 c√¢u)</button>
        <button onclick="startGame(100)">Si√™u kh√≥ (100 c√¢u)</button>
      </div>

      <div class="status-bar" id="status"></div>

      <div class="question-box" id="question-box" style="display: none">
        <div id="question">C√¢u h·ªèi...</div>
        <div class="answers" id="answers"></div>
      </div>

      <div class="summary" id="summary"></div>

      <div class="buttons" id="end-buttons" style="display: none">
        <button onclick="showPage('home')">üè† Trang ch·ªß</button>
        <button onclick="showPage('vocab')">üìò T·ª´ v·ª±ng</button>
        <!-- s·ª≠a l·∫°i g·ªçi startGame v·ªõi bi·∫øn selectedCount -->
        <button onclick="startGame(selectedCount)">üîÅ Ch∆°i l·∫°i</button>
      </div>
    </div>

    <script>
      let currentQuestion = 0,
        lives = 5,
        gameWords = [];
      selectedCount = 20;

      function toggleMenu() {
        const menu = document.getElementById("menu");
        menu.style.display = menu.style.display === "block" ? "none" : "block";
      }

      function showPage(id) {
        document
          .querySelectorAll(".content")
          .forEach((c) => c.classList.remove("active"));
        document.getElementById(id).classList.add("active");
        document.getElementById("menu").style.display = "none";
        document.getElementById("exit-btn").style.display =
          id === "game" ? "block" : "none";

        if (id === "vocab") showVocab();

        if (id === "game") {
          // Hi·ªán ph·∫ßn ch·ªçn m·ª©c ƒë·ªô, ·∫©n c√¢u h·ªèi v√† summary
          document.getElementById("level-select").style.display = "block";
          document.getElementById("question-box").style.display = "none";
          document.getElementById("summary").textContent = "";
          document.getElementById("end-buttons").style.display = "none";
        }
      }

      function showVocab() {
        const list = document.getElementById("vocab-list");
        list.innerHTML = "";
        words.forEach((w) => {
          const li = document.createElement("li");
          li.textContent = `${w.en} - ${w.vi}`;
          list.appendChild(li);
        });
      }

      function startGame(count) {
        selectedCount = count;
        currentQuestion = 0;
        lives = 5;
        gameWords = shuffleArray([...words]).slice(0, selectedCount);
        document.getElementById("summary").textContent = "";
        document.getElementById("end-buttons").style.display = "none";
        document.getElementById("level-select").style.display = "none";
        document.getElementById("question-box").style.display = "block";
        nextQuestion();
      }

      function nextQuestion() {
        if (lives <= 0 || currentQuestion >= gameWords.length) return endGame();
        const q = gameWords[currentQuestion];
        const isEnToVi = Math.random() > 0.5;
        const correct = isEnToVi ? q.vi : q.en;
        const questionText = isEnToVi
          ? `T·ª´ "${q.en}" nghƒ©a l√† g√¨?`
          : `T·ª´ "${q.vi}" l√† g√¨ trong ti·∫øng Anh?`;
        document.getElementById(
          "status"
        ).textContent = `‚ù§Ô∏è M·∫°ng: ${lives} | üî¢ C√¢u: ${currentQuestion + 1}/${
          gameWords.length
        }`;
        document.getElementById("question").textContent = questionText;

        const allAnswers = shuffleArray([q, ...pickRandomWords(q, 3)]).map(
          (w) => (isEnToVi ? w.vi : w.en)
        );

        const answerBox = document.getElementById("answers");
        answerBox.innerHTML = "";
        allAnswers.forEach((ans) => {
          const btn = document.createElement("button");
          btn.textContent = ans;
          btn.onclick = () => {
            if (ans === correct) {
              currentQuestion++;
              nextQuestion();
            } else {
              showWrongAnswerPopup(() => {
                lives--;
                lives <= 0 ? endGame() : nextQuestion();
              });
            }
          };
          answerBox.appendChild(btn);
        });
      }

      function showWrongAnswerPopup(callback) {
        const popup = document.createElement("div");
        popup.style = `
        position: fixed; top: 50%; left: 50%;
        transform: translate(-50%, -50%);
        background: #fff; color: #000;
        padding: 20px; border-radius: 10px;
        box-shadow: 0 0 10px rgba(0,0,0,0.3);
      `;
        popup.innerHTML = `
        <p>‚ùå B·∫°n ƒë√£ tr·∫£ l·ªùi sai!</p>
        <button style="margin-top:10px;padding:5px 15px;
          border:none;background:#333;color:#fff;
          border-radius:5px;cursor:pointer;">ƒê√≥ng</button>
      `;
        document.body.appendChild(popup);
        document
          .querySelectorAll("#answers button")
          .forEach((btn) => (btn.disabled = true));
        popup.querySelector("button").onclick = () => {
          document.body.removeChild(popup);
          callback();
          document
            .querySelectorAll("#answers button")
            .forEach((btn) => (btn.disabled = false));
        };
      }

      function endGame() {
        document.getElementById("question-box").style.display = "none";
        document.getElementById("status").textContent = "";
        document.getElementById(
          "summary"
        ).textContent = `üéâ K·∫øt th√∫c! B·∫°n tr·∫£ l·ªùi ƒë√∫ng ${currentQuestion} / ${gameWords.length} c√¢u.`;
        document.getElementById("end-buttons").style.display = "block";
      }

      function shuffleArray(arr) {
        return arr.sort(() => Math.random() - 0.5);
      }

      function pickRandomWords(exclude, count) {
        return shuffleArray(words.filter((w) => w !== exclude)).slice(0, count);
      }
    </script>

    <script>
      let words = [];

      fetch("hello.text")
        .then((response) => response.text())
        .then((text) => {
          words = text
            .trim()
            .split("\n")
            .map((line) => {
              const [en, vi] = line.split("|").map((s) => s.trim());
              return { en, vi };
            });
        });
    </script>
    <div class="content active" id="home">
      <h1>Ch√†o m·ª´ng ƒë·∫øn v·ªõi web!</h1>
      <p>Ch·ªçn m·ª•c trong menu ƒë·ªÉ b·∫Øt ƒë·∫ßu.</p>
    </div>

    <div class="content" id="vocab">
      <h2>üìö Danh s√°ch t·ª´ v·ª±ng</h2>
      <ul id="vocab-list"></ul>
    </div>
  </body>
</html>
